데이터 전처리: 이상치 탐지 및 처리📕인공지능을 위한 파이썬 라이브러리/📘인공지능을 위한 파이썬 라이브러리 - 5주차/2️⃣데이터 전처리: 이상치 탐지 및 처리Made with2️⃣데이터 전처리: 이상치 탐지 및 처리수업 목표데이터의 이상치가 무엇인지 학습합니다.전처리 과정에서 이상치를 처리하는 방법에 대해서 학습합니다.목차이상치(Outlier)란이상치 탐지 방법이상치 처리 방법요약이상치(Outlier)란❗이상치는 데이터의 일반적인 패턴에서 벗어난 값을 의미합니다.

이러한 값들은 데이터 분석에 부정적인 영향을 미칠 수 있기 때문에,
탐지하고 적절히 처리하는 것이 중요합니다!이상치 탐지 방법📚이상치를 탐지하는 방법에는 여러 가지가 있습니다. 여기서는 기술 통계, 시각화, IQR(사분위수 범위)를 사용한 방법을 살펴보겠습니다.기술 통계 기반 이상치 탐지describe() 함수를 사용하여 데이터의 기본 통계량을 확인하고, 이상치를 의심할 수 있습니다.PythonCopyimport pandas as pd

# 예시 데이터프레임 생성
data = {
'이름': ['철수', '영희', '민수', '지수', '상수'],
'나이': [25, 30, 22, 35, 120], # 120은 이상치로 의심됨
'점수': [90, 85, 95, 80, 88]
}
df = pd.DataFrame(data)
# 기술 통계량 확인
print(df['나이'].describe())

​결과:Plain TextCopycount      5.000000
mean      46.400000
std       41.892848
min       22.000000
25%       25.000000
50%       30.000000
75%       35.000000
max      120.000000
Name: 나이, dtype: float64

​평균(mean)과 표준편차(std)가 큰 차이를 보이는 경우, 또는 최대값(max)이 비정상적으로 높은 경우 이상치를 의심할 수 있습니다.시각화를 사용한 이상치 탐지박스플롯(Box Plot)과 히스토그램을 사용하면 데이터의 분포를 시각적으로 확인할 수 있어, 이상치를 탐지하기 용이합니다.PythonCopyimport matplotlib.pyplot as plt

# 박스플롯으로 이상치 시각화
plt.boxplot(df['나이'])
plt.title('나이의 박스플롯')
plt.show()

​박스플롯의 이상치는 통상적으로 박스(사분위수 범위)의 위아래에 위치한 점으로 표시됩니다.IQR(Interquartile Range)을 사용한 이상치 탐지IQR은 1사분위수(Q1)와 3사분위수(Q3)의 차이로, 이 범위를 벗어나는 데이터를 이상치로 간주할 수 있습니다.PythonCopy# IQR 계산
Q1 = df['나이'].quantile(0.25)
Q3 = df['나이'].quantile(0.75)
IQR = Q3 - Q1

# IQR을 이용한 이상치 탐지
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

outliers = df[(df['나이'] < lower_bound) | (df['나이'] > upper_bound)]
print(outliers)

​결과:Plain TextCopy    이름   나이  점수
4  상수  120  88

​120이라는 값이 IQR 범위를 벗어나므로 이상치로 탐지됩니다.이상치 처리 방법📚이상치를 탐지한 후, 데이터의 특성과 분석 목적에 따라 적절히 처리해야 합니다. 대표적인 처리 방법들을 소개합니다.이상치 제거이상치를 데이터프레임에서 제거할 수 있습니다.PythonCopy# 이상치를 제거한 데이터프레임
df_without_outliers = df[(df['나이'] >= lower_bound) & (df['나이'] <= upper_bound)]
print(df_without_outliers)

​결과:Plain TextCopy   이름   나이  점수
0  철수  25  90
1  영희  30  85
2  민수  22  95
3  지수  35  80

​이상치를 특정 값으로 대체이상치를 특정 값으로 대체할 수 있습니다. 예를 들어, 해당 열의 중앙값으로 대체할 수 있습니다.PythonCopy# '나이'의 중앙값으로 이상치 대체
median_age = df['나이'].median()
df['나이'] = df['나이'].apply(lambda x: median_age if x > upper_bound or x < lower_bound else x)
print(df)

​결과:Plain TextCopy   이름   나이  점수
0  철수  25.0  90
1  영희  30.0  85
2  민수  22.0  95
3  지수  35.0  80
4  상수  30.0  88

​120이었던 이상치가 30으로 대체되었습니다.이상치를 그대로 유지이상치가 중요한 분석 포인트가 될 수 있다고 판단되면, 별도의 처리를 하지 않고 그대로 유지할 수도 있습니다.PythonCopy# 이상치를 그대로 유지하는 경우 (처리하지 않음)
print(df)

​이 방법은 분석 목적에 따라 선택적으로 사용됩니다.요약📚요약이상치는 데이터의 일반적인 패턴에서 벗어난 값이며, 분석 결과에 큰 영향을 줄 수 있습니다.탐지 방법으로는 기술 통계량 확인, 시각화(박스플롯, 히스토그램), IQR을 활용한 방법 등이 있습니다.처리 방법으로는 이상치 제거, 특정 값으로 대체, 또는 이상치를 그대로 유지하는 방법이 있습니다.이제 데이터의 이상치를 효과적으로 탐지하고, 적절히 처리하여 분석의 정확도를 높여보세요! 😊Son minsuckSep 25matplotlib 패키지 설치 명령어 추가하면 좋을 것 같습니다.

!pip install matplotlib